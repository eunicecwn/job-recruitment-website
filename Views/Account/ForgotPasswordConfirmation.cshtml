@{
    ViewData["Title"] = "Check Your Email";
    Layout = null;
}

<link rel="stylesheet" href="~/css/ForgotPasswdCom.css" />
<link rel="shortcut icon" href="/images/logo.png">

<div class="confirmation-container">
    <div class="confirmation-card">
        <div class="card-header">
            <div class="logo-container">
                <img src="/images/logo.png" alt="Company Logo" class="logo-img" />
                <h2>Check Your Email</h2>
            </div>
            <p>We've sent you a password reset link</p>
        </div>

        <div class="card-body">
            <div class="main-message">
                <h4>Reset link sent successfully!</h4>
                <p>We've sent a password reset link to your email address. Please check your inbox and follow the instructions to reset your password.</p>
            </div>

            @if (!string.IsNullOrEmpty(ViewBag.Email))
            {
                <div class="email-display">
                    Email sent to: @ViewBag.Email
                </div>
            }

            <div class="instructions">
                <h5>📋 What to do next:</h5>
                <ol>
                    <li>Check your email inbox for a message from HireRightPro</li>
                    <li>Look for an email with the subject "Password Reset Request"</li>
                    <li>Click the "Reset My Password" button in the email</li>
                    <li>Create your new password on the secure page</li>
                    <li>Login with your new password</li>
                </ol>
            </div>

            <div class="security-note">
                <p>
                    <span class="icon">🕒</span>
                    <strong>Important:</strong> The reset link will expire in 15 minutes for security reasons. If you don't reset your password within this time, you'll need to request a new link.
                </p>
            </div>

            <div class="help-section">
                <h5>❓ Can't find the email?</h5>
                <ul>
                    <li>Check your spam/junk mail folder</li>
                    <li>Make sure you entered the correct email address</li>
                    <li>Wait a few minutes for the email to arrive</li>
                    <li>Add hiredrightpro@gmail.com to your contacts</li>
                    <li>Check any email filters that might be blocking the message</li>
                </ul>
            </div>

            <div class="action-buttons">
                <a href="@Url.Action("Login", "Account")" class="btn btn-primary">
                    Back to Login
                </a>
                <a href="@Url.Action("ForgotPassword", "Account")" class="btn btn-secondary">
                    Send Another Email
                </a>
            </div>

            <div class="security-note" style="margin-top: 30px;">
                <p>
                    <span class="icon">🛡️</span>
                    If you continue to have problems, please contact our support team at
                    <strong><a href='mailto:hiredrightpro@gmail.com'>hiredrightpro@gmail.com</a></strong>
                </p>
            </div>
        </div>
    </div>
</div>

<script>
    // Auto-refresh functionality (optional)
    let refreshCount = 0;
    const maxRefreshes = 3;

    function showRefreshOption() {
        if (refreshCount < maxRefreshes) {
            const confirmRefresh = confirm('Still waiting for the email? Click OK to send another reset link, or Cancel to keep waiting.');
            if (confirmRefresh) {
                refreshCount++;
                window.location.href = '@Url.Action("ForgotPassword", "Account")';
            }
        }
    }

    // Show refresh option after 2 minutes
    setTimeout(showRefreshOption, 120000);

    // Countdown timer for link expiration
    let timeLeft = 900; // 15 minutes in seconds

    function updateCountdown() {
        const hours = Math.floor(timeLeft / 3600);
        const minutes = Math.floor((timeLeft % 3600) / 60);
        const seconds = timeLeft % 60;

        const countdownElement = document.getElementById('countdown');
        if (countdownElement) {
            countdownElement.textContent = `Link expires in: ${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        if (timeLeft <= 0) {
            if (countdownElement) {
                countdownElement.textContent = 'Reset link has expired';
                countdownElement.style.color = '#dc3545';
            }
            return;
        }

        timeLeft--;
        setTimeout(updateCountdown, 1000);
    }

    // Add countdown element if desired
    document.addEventListener('DOMContentLoaded', function() {
        const securityNote = document.querySelector('.security-note');
        if (securityNote) {
            const countdownDiv = document.createElement('div');
            countdownDiv.className = 'countdown';
            countdownDiv.id = 'countdown';
            securityNote.appendChild(countdownDiv);
            updateCountdown();
        }
    });
</script>